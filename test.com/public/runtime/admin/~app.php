<?php  if (!defined('THINK_PATH')) exit(); filter_request($_REQUEST); filter_request($_GET); filter_request($_POST); define("AUTH_NOT_LOGIN", 1); define("AUTH_NOT_AUTH", 2); function conf($name,$value = false) { if($value === false) { return C($name); } else { if(M("Conf")->where("is_effect=1 and name='".$name."'")->count()>0) { if(in_array($name,array('EXPIRED_TIME','SUBMIT_DELAY','SEND_SPAN','WATER_ALPHA','MAX_IMAGE_SIZE','INDEX_LEFT_STORE','INDEX_LEFT_TUAN','INDEX_LEFT_YOUHUI','INDEX_LEFT_DAIJIN','INDEX_LEFT_EVENT','INDEX_RIGHT_STORE','INDEX_RIGHT_TUAN','INDEX_RIGHT_YOUHUI','INDEX_RIGHT_DAIJIN','INDEX_RIGHT_EVENT','SIDE_DEAL_COUNT','DEAL_PAGE_SIZE','PAGE_SIZE','BATCH_PAGE_SIZE','HELP_CATE_LIMIT','HELP_ITEM_LIMIT','REC_HOT_LIMIT','REC_NEW_LIMIT','REC_BEST_LIMIT','REC_CATE_GOODS_LIMIT','SALE_LIST','INDEX_NOTICE_COUNT','RELATE_GOODS_LIMIT'))) { $value = intval($value); } M("Conf")->where("is_effect=1 and name='".$name."'")->setField("value",$value); } C($name,$value); } } function write_timezone($zone='') { if($zone=='') $zone = conf('TIME_ZONE'); $var = array( '0' => 'UTC', '8' => 'PRC', ); $timezone_config_str = "<?php\r\n"; $timezone_config_str .= "return array(\r\n"; $timezone_config_str.="'DEFAULT_TIMEZONE'=>'".$var[$zone]."',\r\n"; $timezone_config_str.=");\r\n"; $timezone_config_str.="?>"; @file_put_contents(get_real_path()."public/timezone_config.php",$timezone_config_str); } function save_log($msg,$status) { if(conf("ADMIN_LOG")==1) { $adm_session = es_session::get(md5(conf("AUTH_KEY"))); $log_data['log_info'] = $msg; $log_data['log_time'] = get_gmtime(); $log_data['log_admin'] = intval($adm_session['adm_id']); $log_data['log_ip'] = get_client_ip(); $log_data['log_status'] = $status; $log_data['module'] = MODULE_NAME; $log_data['action'] = ACTION_NAME; $type = ''; if(MODULE_NAME=='Public'&&ACTION_NAME=='do_login'){ $type = '管理员登录'; }elseif(MODULE_NAME=='User'&&ACTION_NAME=='modify_account'){ $type = '管理员金额修改'; } if($type){ $GLOBALS['msg']->manage_msg('MSG_ADMIN_MANAGE','',array('type'=>$type,'content'=>$msg)); } M("Log")->add($log_data); } } function get_toogle_status($tag,$id,$field) { if($tag) { return "<span class='is_effect' onclick=\"toogle_status(".$id.",this,'".$field."');\">".l("YES")."</span>"; } else { return "<span class='is_effect' onclick=\"toogle_status(".$id.",this,'".$field."');\">".l("NO")."</span>"; } } function get_is_effect($tag,$id) { if($tag) { return "<span class='is_effect' onclick='set_effect(".$id.",this);'>".l("IS_EFFECT_1")."</span>"; } else { return "<span class='is_effect' onclick='set_effect(".$id.",this);'>".l("IS_EFFECT_0")."</span>"; } } function get_is_show($tag,$id) { if($tag) { return "<span class='is_show' onclick='set_show(".$id.",this);'>".l("IS_SHOW_1")."</span>"; } else { return "<span class='is_show' onclick='set_show(".$id.",this);'>".l("IS_SHOW_0")."</span>"; } } function get_is_ban($tag,$id) { if($tag) { return "<span class='is_effect' onclick='set_ban(".$id.",this);'>".l("IS_BAN_1")."</span>"; } else { return "<span class='is_effect' onclick='set_ban(".$id.",this);'>".l("IS_BAN_0")."</span>"; } } function get_is_hot_on($tag,$id) { if($tag) { return "<span class='is_effect' onclick='set_hot_on(".$id.",this);'>".l("IS_HOT_ON_1")."</span>"; } else { return "<span class='is_effect' onclick='set_hot_on(".$id.",this);'>".l("IS_HOT_ON_0")."</span>"; } } function get_sort($sort,$id) { if($tag) { return "<span class='sort_span' onclick='set_sort(".$id.",".$sort.",this);'>".$sort."</span>"; } else { return "<span class='sort_span' onclick='set_sort(".$id.",".$sort.",this);'>".$sort."</span>"; } } function get_recommend($recommend,$id) { if($recommend){ return "<span class='is_effect' onclick='set_recommend(".$id.",this);'>".l("IS_RECOMMEND_1")."</span>"; }else{ return "<span class='is_effect' onclick='set_recommend(".$id.",this);'>".l("IS_RECOMMEND_0")."</span>"; } } function get_module($module_id) { return M("RoleModule")->where("id=".$module_id)->getField("module"); } function get_group($group_id) { if($group_data = M("RoleGroup")->where("id=".$group_id)->find()) $group_name = $group_data['name']; else $group_name = L("SYSTEM_NODE"); return $group_name; } function get_role_name($role_id) { return M("Role")->where("id=".$role_id)->getField("name"); } function get_admin_name($admin_id) { $adm_name = M("Admin")->where("id=".$admin_id)->getField("adm_name"); if($adm_name) return $adm_name; else return "--"; } function get_log_status($status) { return l("LOG_STATUS_".$status); } function check_sort($sort) { if(!is_numeric($sort)) { return false; } return true; } function check_empty($data) { if(trim($data)=='') { return false; } return true; } function set_default($null,$adm_id) { $admin_name = M("Admin")->where("id=".$adm_id)->getField("adm_name"); if($admin_name == conf("DEFAULT_ADMIN")) { return "<span style='color:#f30;'>".l("DEFAULT_ADMIN")."</span>"; } else { return "<a href='".u("Admin/set_default",array("id"=>$adm_id))."'>".l("SET_DEFAULT_ADMIN")."</a>"; } } function get_all_files( $path ) { $list = array(); $dir = @opendir($path); while (false !== ($file = @readdir($dir))) { if($file!='.'&&$file!='..') if( is_dir( $path.$file."/" ) ){ $list = array_merge( $list , get_all_files( $path.$file."/" ) ); } else { $list[] = $path.$file; } } @closedir($dir); return $list; } function get_send_type_msg($status) { if($status==0) { return l("SMS_SEND"); }elseif($status==2){ return '微信'; } else { return l("MAIL_SEND"); } } function get_is_send($is_send) { if($is_send==0) return L("NO"); else return L("YES"); } function get_send_result($result) { if($result==0) { return L("FAILED"); } else { return L("SUCCESS"); } } function get_status($status) { if($status) { return l("YES"); } else return l("NO"); } function show_content($content,$id) { return "<a title='".l("VIEW")."' href='javascript:void(0);' onclick='show_content(".$id.")'>".l("VIEW")."</a>"; } function get_title($title) { return "<span title='".$title."'>".msubstr($title)."</span>"; } function get_send_status($status) { return L("SEND_STATUS_".$status); } function get_send_type($send_type) { return l("SEND_TYPE_".$send_type); } function get_indeximage_type($type=0){ switch($type){ case 1: return "家族APP跳转"; break; case 2: return "排行榜APP跳转"; break; case 3: return "PC首页"; break; case 4: return "启动广告"; break; case 6: return "跳转线下约课详情"; case 7: return "跳转一对一约课"; case 8: return "跳转到直播间"; case 9: return "跳转课程详情"; case 10: return "会员动态跳转"; break; case 11: return "动态详情跳转"; break; default: return "网页url链接"; } } function get_position($type=0){ switch($type){ case 1: return "家族轮播图"; break; case 2: return "排行榜轮播图"; break; case 3: return "PC首页"; break; case 4: return "启动广告"; break; case 5: return '首页直播推荐'; case 9: return '首页预约课程推荐'; case 6: return '课堂首页轮播图'; case 7: return '约课首页轮播图'; case 8: return '线下约课轮播图'; case 10: return "首页-美女轮播图"; break; case 11: return "首页-写真轮播图"; break; default: return "轮播图"; } } return array ( 'app_debug' => false, 'app_domain_deploy' => false, 'app_plugin_on' => false, 'app_file_case' => false, 'app_group_depr' => '.', 'app_group_list' => '', 'app_autoload_reg' => false, 'app_autoload_path' => 'Think.Util.,@.COM.', 'app_config_list' => array ( 0 => 'taglibs', 1 => 'routes', 2 => 'tags', 3 => 'htmls', 4 => 'modules', 5 => 'actions', ), 'cookie_expire' => 3600, 'cookie_domain' => '', 'cookie_path' => '/', 'cookie_prefix' => '', 'default_app' => '@', 'default_group' => '', 'default_module' => 'Index', 'default_action' => 'index', 'default_charset' => 'utf-8', 'default_timezone' => 'PRC', 'default_ajax_return' => 'JSON', 'default_theme' => 'default', 'default_lang' => 'zh-cn', 'db_type' => 'mysql', 'db_host' => '127.0.0.1', 'db_name' => 'ktv', 'db_user' => 'ktv', 'db_pwd' => '84cca1e6', 'db_port' => '3306', 'db_prefix' => '', 'db_suffix' => '', 'db_fieldtype_check' => false, 'db_fields_cache' => true, 'db_charset' => 'utf8', 'db_deploy_type' => 0, 'db_rw_separate' => false, 'data_cache_time' => -1, 'data_cache_compress' => false, 'data_cache_check' => false, 'data_cache_type' => 'File', 'data_cache_path' => './admin/../public/runtime/admin/Temp/', 'data_cache_subdir' => false, 'data_path_level' => 1, 'error_message' => '您浏览的页面暂时发生了错误！请稍后再试～', 'error_page' => '', 'html_cache_on' => false, 'html_cache_time' => 60, 'html_read_type' => 0, 'html_file_suffix' => '.shtml', 'lang_switch_on' => false, 'lang_auto_detect' => true, 'log_record' => false, 'log_file_size' => 2097152, 'log_record_level' => array ( 0 => 'EMERG', 1 => 'ALERT', 2 => 'CRIT', 3 => 'ERR', ), 'page_rollpage' => 5, 'page_listrows' => 10, 'session_auto_start' => true, 'show_run_time' => false, 'show_adv_time' => false, 'show_db_times' => false, 'show_cache_times' => false, 'show_use_mem' => false, 'show_page_trace' => false, 'show_error_msg' => true, 'tmpl_engine_type' => 'Think', 'tmpl_detect_theme' => false, 'tmpl_template_suffix' => '.html', 'tmpl_cachfile_suffix' => '.php', 'tmpl_deny_func_list' => 'echo,exit', 'tmpl_parse_string' => '', 'tmpl_l_delim' => '{', 'tmpl_r_delim' => '}', 'tmpl_var_identify' => 'array', 'tmpl_strip_space' => false, 'tmpl_cache_on' => true, 'tmpl_cache_time' => -1, 'tmpl_action_error' => 'Public:error', 'tmpl_action_success' => 'Public:success', 'tmpl_trace_file' => './admin/ThinkPHP/Tpl/PageTrace.tpl.php', 'tmpl_exception_file' => './admin/ThinkPHP/Tpl/ThinkException.tpl.php', 'tmpl_file_depr' => '/', 'taglib_begin' => '<', 'taglib_end' => '>', 'taglib_load' => true, 'taglib_build_in' => 'cx', 'taglib_pre_load' => '', 'tag_nested_level' => 3, 'tag_extend_parse' => '', 'token_on' => 0, 'token_name' => '__hash__', 'token_type' => 'md5', 'url_case_insensitive' => false, 'url_router_on' => false, 'url_dispatch_on' => true, 'url_model' => '0', 'url_pathinfo_model' => 2, 'url_pathinfo_depr' => '/', 'url_html_suffix' => '', 'var_group' => 'g', 'var_module' => 'm', 'var_action' => 'a', 'var_router' => 'r', 'var_page' => 'p', 'var_template' => 't', 'var_language' => 'l', 'var_ajax_submit' => 'ajax', 'var_pathinfo' => 's', 'is_redis_jq' => false, 'rdb_client' => '47.93.248.81', 'rdb_port' => '6379', 'rdb_password' => 'qingketv', 'session_client' => '47.93.248.81', 'session_port' => '6379', 'session_password' => 'qingketv', 'cache_client' => '47.93.248.81', 'cache_port' => '6379', 'cache_password' => 'qingketv', 'session_file_path' => '', 'db_cache_app' => array ( 0 => 'index', ), 'db_cache_tables' => array ( 0 => 'admin', ), 'db_distribution' => array ( ), 'oss_domain' => 'http://liveimage.fanwe.net', 'oss_domain_https' => '', 'oss_file_domain' => 'http://ilvbfile.fanwe.net', 'oss_bucket_name' => 'ilvbfanwe', 'oss_access_id' => '', 'oss_access_key' => '', 'oss_endpoint' => '', 'oss_internal_endpoint' => '', 'oss_endpoint_with_bucket_name' => true, 'new_oss' => true, 'oss_no_save_localhost' => 0, 'redis_distribution_fun' => array ( 0 => 'index#index', 1 => 'index#new_video', 2 => 'index#search_area', 3 => 'video#viewer', ), 'aes_extra_fun' => array ( 0 => 'app#init', 1 => 'login#do_login', 2 => 'user#usersig', 3 => 'login#wx_login', 4 => 'login#qq_login', 5 => 'login#sina_login', 6 => 'login#visitors_login', 7 => 'login#send_mobile_verify', 8 => 'login#do_update', 9 => 'app#aliyun_sts', 10 => 'login#is_user_verify', ), 'cache_type' => 'Rediscache', 'cache_log' => false, 'session_type' => 'Rediscache', 'allow_db_distribute' => false, 'is_jq' => false, 'jq_url' => '', 'redis_prefix' => 'fanwe0000001:', 'redis_prefix_db' => 0, 'css_js_oss' => true, 'oss_type' => 'ALI_OSS', 'local_image_url' => '', 'order_distribute_count' => '5', 'domain_root' => '', 'app_name' => '云直播', 'app_sub_ver' => 2.4399999999999999, 'rewriter_depart' => '-', 'site_domain' => '', 'venture_investment' => '0', '_taglibs_' => array ( 'html' => '@.TagLib.TagLibHtml', ), ); ?>